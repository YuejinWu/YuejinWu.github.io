<!DOCTYPE html><html lang="en &amp;&amp; zh-Hans" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>Intermediate-SQL 解读 | Yuejin's Blog</title><meta name="keywords" content="Database,SQL"><meta name="author" content="Yuejin Wu"><meta name="copyright" content="Yuejin Wu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Intermediate-SQL 解读"><meta name="application-name" content="Intermediate-SQL 解读"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Intermediate-SQL 解读"><meta property="og:url" content="http://example.com/2025/12/24/DB_Intermediate%20SQL/index.html"><meta property="og:site_name" content="Yuejin's Blog"><meta property="og:description" content="数据库关系模式图示takes (学生选课)  ID course_id sec_id semester year grade  section (课程开设)  course_id sec_id semester year building room_no time_slot_id  classro"><meta property="og:locale" content="en &amp;&amp; zh-Hans"><meta property="og:image" content="http://example.com/img/SQL_cover.png"><meta property="article:author" content="Yuejin Wu"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/img/SQL_cover.png"><meta name="description" content="数据库关系模式图示takes (学生选课)  ID course_id sec_id semester year grade  section (课程开设)  course_id sec_id semester year building room_no time_slot_id  classro"><link rel="shortcut icon" href="/img/mylogo.jpg"><link rel="canonical" href="http://example.com/2025/12/24/DB_Intermediate%20SQL/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@6.1.6/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: {"enable":true,"ck":null,"LingQueMonitorID":null},
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Yuejin Wu","link":"链接: ","source":"来源: Yuejin's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.2.0/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.2.0/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Yuejin's Blog',
  title: 'Intermediate-SQL 解读',
  postAI: '',
  pageFillDescription: '数据库关系模式图示, 4.1 连接表达式, (1) 自然连接操作, (2) 外连接, 1. 左外连接, 2. 右外连接, 3. 全外连接, 连接关系 – 示例, 4.2 视图, 视图定义, 视图定义语句, 视图示例, 使用其他视图定义的视图, 视图展开, 视图的更新, 4.3 事务, 事务示例：银行账户转账, T-SQL 事务示例, 4.4 完整性约束, 完整性约束分类, 完整性约束示例, 单关系上的约束, Not Null 约束, Unique 约束, Check 子句, 参照完整性, 参照完整性依赖, 参照完整性声明, 参照完整性中的级联操作, 事务期间的完整性约束违反, 4.5 数据类型和模式, 内置数据类型, 类型转换, B. 使用包含算术运算符的 CAST, C. 使用 CAST 进行连接, D. 使用 CAST 生成可读性更高的文本, 默认值, 用户定义类型, 用户定义域, 复杂检查条件和断言, 4.6 SQL 中的索引定义, 索引定义示例, 4.7 授权, 对数据库部分的授权形式, 对数据库模式修改的授权形式（第8章）, 授权规范, 权限类型, 撤销授权, 角色, 视图上的授权, 其他授权特性, 实验要求与讨论, 实验要求：外键关联与级联操作, 数据库系统设计时是否使用外键？, 方式1：设置数据库表的外键, 方式2：不设置外键由应用程序在业务逻辑层维护数据一致性、完整性, 方式3：不设置外键业务层应用逻辑也不处理数据间一致性, LTE 网络数据库课程实验讨论, LTE 网络数据库实验要求, 附录 4-1 T-SQL 中的 CREATE TABLE, 本章内容总结（大纲）数据库关系模式图示学生选课课程开设教室时间槽教师授课课程先修课程学生系导师教师连接表达式定义连接操作接受两个关系并返回结果作为另一个关系定义连接操作是一种笛卡尔积要求两个关系中的元组相匹配连接结果中的属性来源于笛卡尔积选择定义连接条件定义两个关系中的哪些元组相匹配以及结果中存在哪些属性定义连接类型定义如何处理每个关系中不与另一个关系中任何元组匹配的元组连接类型连接条件内连接左外连接谓词右外连接全外连接自然连接操作考虑两个关系课程表先修课表查询查询的结果的课程信息缺失因为中没有的先修课信息缺失因为中没有外连接定义连接操作的扩展用于避免信息丢失计算连接然后将一个关系中不与另一个关系中任何元组匹配的元组添加到连接结果中使用空值左外连接右外连接全外连接连接关系示例内连接与自然连接的区别视图并非所有用户都希望看到整个逻辑模型例如某人需要知道教师的姓名和所在系但不需要知道其工资可以查看一个关系定义任何不属于概念模型但作为虚拟关系对用户可见的关系视图对某些用户隐藏了某些数据视图定义注意视图对一个或多个关系的投影视图作为虚拟表存在注意视图被称为虚拟关系表只有视图的定义存储在数据库系统中视图的元组存储在基础关系中视图的求值被归结为定义该视图的关系代数表达式的求值注意子句和子句的区别子句创建一个临时表来存储查询结果创建的临时表在执行结束后被取消定义物化视图视图的定义和数据都存储在数据库系统中视图定义语句定义使用语句定义视图查询表达式其中查询表达式是表达式视图名称用表示视图名称可用于引用该虚拟表视图定义与创建新关系不同视图定义导致保存一个表达式视图示例不包含工资的教师视图查找系的所有教师部门工资总额视图使用其他视图定义的视图创建视图基于创建视图注意一个视图可以用于定义另一个视图的表达式定义如果视图关系用于定义视图关系的表达式中则称直接依赖于定义如果直接依赖于或者存在从到的依赖路径则称视图关系依赖于视图关系定义如果视图关系依赖于自身则称其为递归的视图展开展开查询或另一个视图中对视图的使用视图的更新向视图中插入新元组此插入操作必须表示为向关系中插入元组事务定义事务由一系列查询和或更新语句组成它是一个工作单元注意属性原子性一致性隔离性持久性原子事务要么完全执行要么完全回滚就像从未发生过一样与并发事务隔离注意当事务语句执行时事务隐式开始事务以以下语句结束更新永久生效所有已执行的更新被撤销事务示例银行账户转账初始状态转账操作事务示例事务变量定义事务命名事务开始打开数据库将上述批语句提交修改帐户修改帐户事务提交完整性约束定义完整性约束防止数据库遭受意外破坏确保对数据库的授权更改不会导致数据一致性的丢失教师姓名不能为空任意两个教师不能有相同的教师关系中的每个系名必须在关系中有匹配的系名完整性约束分类类型属性级元组级关系级静态数据类型数据格式域约束空值属性值间的约束例如映射基数约束实体完整性参照完整性函数依赖动态属性值或属性定义更新的约束属性值间的约束例如新旧值关系事务约束原子性一致性隔离性持久性完整性约束示例例表中经理的工资不应低于美元例表其中是从和派生的属性例表中的学号不应为空例学生的年龄只能增加例当修改元组时新工资需满足例统计约束在表中经理的工资应该是工人工资的四倍以上单关系上的约束使用命令定义关系是关系名每个是关系模式中的一个属性名是属性域中值的数据类型注意完整性约束包括其中是一个谓词约束约束定义约束形式如下属性构成一个候选码允许候选码为空与主键不同示例子句应用于关系声明和域声明其中是一个谓词示例确保属性值在中参照完整性参照完整性确保在一个关系的给定属性外键上出现的值也出现在另一个关系的对应属性主键上如果是出现在关系元组中的一个系名那么关系中必须存在的元组参照完整性依赖定义设和是分别具有主键和的关系例如的子集例如是一个外键来自引用关系中的如果对于中的每个元组在中必须存在一个元组使得注意定义参照完整性约束被称为子集依赖因为它可以写成例如表的外键引用被引用表的主键属性注意良好的数据库设计应确保任何关系模式只能通过其外键引用其他关系模式参照完整性声明主键候选键和外键可以在语句中指定子句列出构成主键的属性子句列出构成候选键的属性子句列出构成外键的属性以及外键引用的关系名外键引用被引用表的主键属性参照完整性中的级联操作简略声明详细声明支持级联级联的替代操作对被引用表的删除更新操作将导致对引用表的级联删除更新事务期间的完整性约束违反示例如何在具有主键外键关联的两个表上修改数据如何插入元组而不引起约束违反在插入之前先插入该人的父亲和母亲或者先将和设置为在插入所有人之后再更新如果和属性声明为则不可行数据类型和模式内置数据类型日期包含位年月日例如一天中的时间时分秒例如日期一天中的时间例如时间段如果和是类型那么是一个其值是从日期到日期的天数例如类型转换将字符串转换为类型例如例如从日期或时间值中提取部分对于日期或时间值可以提取其各个字段例如例如用于数据类型转换示例同时使用和每个示例都检索列表价格第一位是的产品名称并将转换为使用使用使用包含算术运算符的将销售额除以佣金百分比结果四舍五入到最接近的整数后转换为使用进行连接使用连接非字符非二进制表达式使用生成可读性更高的文本使用将列转换为列默认值插入数据时未指定则使用默认值用户定义类型使用子句定义用户定义类型示例使用将一个类型的值转换为另一个域例如然后表达式可以被求值用户定义域构造创建用户定义的域类型类型和域相似域可以指定约束例如示例复杂检查条件和断言一些构造如和被定义为用于指定复杂的完整性约束但是目前大多数数据库系统不支持它们复杂条件示例对于关系每个元组中的实际上应该是关系中的一个时间槽标识符此约束可以定义为在中使用断言断言是表示我们希望数据库始终满足的条件的谓词例如域约束参照完整性约束断言的形式断言名称谓词同样不被大多数如支持为什么当创建断言时测试其有效性任何对数据库的修改只有在该断言不被违反时才被允许这种测试可能引入显著的开销因此应非常谨慎地使用断言断言示例对于关系中的每个元组属性的值必须等于该学生成功完成的课程的学分总和中的索引定义许多查询只引用表中的一小部分记录读取每条记录以查找具有特定值的记录是低效的关系属性上的索引是一种数据结构它允许数据库系统高效地查找关系中在该属性上具有指定值的那些元组而无需扫描关系的所有元组使用命令创建索引索引名关系名属性索引定义示例查询时可以利用索引高效定位记录授权对数据库部分的授权形式允许读取数据但不允许修改允许插入新数据但不允许修改现有数据允许修改数据但不允许删除允许删除数据对数据库模式修改的授权形式第章允许创建新关系允许在关系中添加或删除属性允许删除关系允许创建和删除索引授权规范使用语句授予授权权限列表关系名或视图名用户列表用户列表可以是用户或允许所有有效用户获得授予的权限授予视图上的权限并不意味着授予对底层关系的任何权限权限的授予者必须已经拥有指定项目上的该权限或者是数据库管理员权限类型允许读取关系或使用视图进行查询的能力示例授予用户对关系的授权插入元组的能力使用语句更新的能力删除元组的能力用作所有允许权限的简写形式撤销授权使用语句撤销授权权限列表关系名或视图名用户列表示例权限列表可以是以撤销撤销者可能持有的所有权限如果撤销列表包含则所有用户都会失去该权限除非他们被明确授予该权限角色创建角色将角色授予用户可以向角色授予权限角色可以授予给用户也可以授予给其他角色继承的所有权限角色链视图上的授权假设成员执行如果发生以下情况会怎样对没有权限视图创建者对没有某些权限其他授权特性权限用于创建外键为什么需要这个权限转移级联撤销限制撤销等等更多细节请阅读第节实验要求与讨论实验要求外键关联与级联操作平台任务定义两张表间的无级联修改和有级联修改的外键关联判断当增删改一张表中的主键外键值时的反应数据库系统设计时是否使用外键外键反映了不同数据项间的逻辑关联和约束关系是一种客观存在例如表和表中的对外键的处理方式反映了对这种数据相互间关系的处理态度需要根据实际情况而定考虑数据完整性处理效率等多种因素并非简单的需要外键或不设外键方式设置数据库表的外键优点自动维护数据间的关联约束关系缺点数据导入增删改时多个表间的相互关联保证了数据一致性和完整性但影响到整体数据处理效率额外的处理开销例如插入一条不存在的元组失败并影响前面已经成功插入的数据局部错误影响整体方式不设置外键由应用程序在业务逻辑层维护数据一致性完整性优点避免局部错误影响整体进度业务逻辑层的数据一致性处理速度可以比较快例如将数据提至内存中批量处理缺点对应用层业务处理程序设计的额外要求上述两种方式用在对数据一致性完整性要求高的场景下例如银行方式不设置外键业务层应用逻辑也不处理数据间一致性牺牲数据的正确性换取数据处理的效率例如大数据应用场景下对数据精度正确性要求不高网络数据库课程实验讨论表中的主小区邻小区对应于中的小区标识实际应用中不建议在与之间建立外键否则两表间由于强行的外键约束可能带来低效的数据处理例向中大批量导入数据时插入的某条测量报告数据中的某些主小区邻小区没有出现在表中导致本条以及前面各条已成功插入的测量报告均插入失败例当中某个小区修改名字时在数据量非常大例如级别上亿条表中以该小区作为主邻小区的测量报告也必须随之修改现网环境中不一致的原因中的测量报告的测量范围超出的范围有些测量报告的主小区邻小区没有出现在表中表中的小区数据有可能被修改导致与中的测量报告不一致网络数据库实验要求在建表数据导入阶段先不要建立与间的外键数据导入完成后再建立表间外键关联观察是否能建立如果建立中主键值的变化对的影响或反之在已建立的表中增加外键的方法参见具体平台用户手册附录中的此处详细语法结构图展示了中语句的复杂选项包括列定义约束物理存储选项分区文件组索引类型聚集非聚集等强调了物理设计层面的考量具体语法细节可参考文档本章内容总结大纲数据类型和模式日期和时间类型类型转换和格式化函数默认值大对象类型用户定义类型扩展生成唯一键值模式目录环境连接表达式用于多表访问自然连接连接条件外连接连接类型和条件视图定义查询更新物化视图事务定义示例完整性约束参照完整性复杂检查约束和断言为约束命名事务期间的约束违反中的索引定义授权角色实验完整性约束',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-12-24 01:47:20',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><style>
  /* === 只添加半透明磨砂效果，不改变任何布局 === */
  
  /* 1. 导航栏内所有可点击元素添加磨砂背景 */
  #nav a,
  #nav button {
    /* 保持原有布局，只添加背景效果 */
    backdrop-filter: blur(6px) !important;
    -webkit-backdrop-filter: blur(6px) !important;
    transition: backdrop-filter 0.3s ease !important;
  }
  
  /* 2. 浅色模式：白色半透明 */
  body:not([data-theme="dark"]) #nav a,
  body:not([data-theme="dark"]) #nav button {
    background-color: rgba(255, 255, 255, 0.1) !important;
  }
  
  /* 3. 深色模式：黑色半透明 */
  [data-theme="dark"] #nav a,
  [data-theme="dark"] #nav button {
    background-color: rgba(0, 0, 0, 0.1) !important;
  }
  
  /* 4. 悬停效果：稍微增加透明度 */
  #nav a:hover,
  #nav button:hover {
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
  }
  
  body:not([data-theme="dark"]) #nav a:hover,
  body:not([data-theme="dark"]) #nav button:hover {
    background-color: rgba(255, 255, 255, 0.15) !important;
  }
  
  [data-theme="dark"] #nav a:hover,
  [data-theme="dark"] #nav button:hover {
    background-color: rgba(0, 0, 0, 0.15) !important;
  }
</style>
<link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 8.1.1"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://hexo.anheyu.com/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Yuejin's Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI-Platform/" style="font-size: 1.05rem;">AI Platform<sup>1</sup></a><a href="/tags/Database/" style="font-size: 1.05rem;">Database<sup>6</sup></a><a href="/tags/English/" style="font-size: 1.05rem;">English<sup>1</sup></a><a href="/tags/RNN/" style="font-size: 1.05rem;">RNN<sup>1</sup></a><a href="/tags/SQL/" style="font-size: 1.05rem;">SQL<sup>5</sup></a><a href="/tags/Self-Attention/" style="font-size: 1.05rem;">Self Attention<sup>1</sup></a><a href="/tags/plan/" style="font-size: 1.05rem;">plan<sup>2</sup></a><a href="/tags/%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B/" style="font-size: 1.05rem;">关系模型<sup>1</sup></a><a href="/tags/%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B/" style="font-size: 1.05rem;">自注意力<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/12/"><span class="card-archive-list-date">December 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url">数据库</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Database/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Database</span></a><a class="article-meta__tags" href="/tags/SQL/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>SQL</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Intermediate-SQL 解读</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-12-23T17:45:01.113Z" title="发表于 2025-12-24 01:45:01">2025-12-24</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-12-23T17:47:20.257Z" title="更新于 2025-12-24 01:47:20">2025-12-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/img/SQL_cover.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/12/24/DB_Intermediate%20SQL/"><header><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url">数据库</a><a href="/tags/Database/" tabindex="-1" itemprop="url">Database</a><a href="/tags/SQL/" tabindex="-1" itemprop="url">SQL</a><h1 id="CrawlerTitle" itemprop="name headline">Intermediate-SQL 解读</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Yuejin Wu</span><time itemprop="dateCreated datePublished" datetime="2025-12-23T17:45:01.113Z" title="发表于 2025-12-24 01:45:01">2025-12-24</time><time itemprop="dateCreated datePublished" datetime="2025-12-23T17:47:20.257Z" title="更新于 2025-12-24 01:47:20">2025-12-24</time></header><hr>
<h3 id="数据库关系模式图示"><a href="#数据库关系模式图示" class="headerlink" title="数据库关系模式图示"></a>数据库关系模式图示</h3><p><strong>takes</strong> (学生选课)</p>
<ul>
<li>ID</li>
<li>course_id</li>
<li>sec_id</li>
<li>semester</li>
<li>year</li>
<li>grade</li>
</ul>
<p><strong>section</strong> (课程开设)</p>
<ul>
<li>course_id</li>
<li>sec_id</li>
<li>semester</li>
<li>year</li>
<li>building</li>
<li>room_no</li>
<li>time_slot_id</li>
</ul>
<p><strong>classroom</strong> (教室)</p>
<ul>
<li>building</li>
<li>room_no</li>
<li>capacity</li>
</ul>
<p><strong>time_slot</strong> (时间槽)</p>
<ul>
<li>time_slot_id</li>
<li>day</li>
<li>start_time</li>
<li>end_time</li>
</ul>
<p><strong>teaches</strong> (教师授课)</p>
<ul>
<li>ID</li>
<li>course_id</li>
<li>sec_id</li>
<li>semester</li>
<li>year</li>
</ul>
<p><strong>course</strong> (课程)</p>
<ul>
<li>course_id</li>
<li>title</li>
<li>dept_name</li>
<li>credits</li>
</ul>
<p><strong>prereq</strong> (先修课程)</p>
<ul>
<li>course_id</li>
<li>prereq_id</li>
</ul>
<p><strong>student</strong> (学生)</p>
<ul>
<li>ID</li>
<li>name</li>
<li>dept_name</li>
<li>tot_cred</li>
</ul>
<p><strong>department</strong> (系)</p>
<ul>
<li>dept_name</li>
<li>building</li>
<li>budget</li>
</ul>
<p><strong>advisor</strong> (导师)</p>
<ul>
<li>s_id</li>
<li>i_id</li>
</ul>
<p><strong>instructor</strong> (教师)</p>
<ul>
<li>ID</li>
<li>name</li>
<li>dept_name</li>
<li>salary</li>
</ul>
<hr>
<h2 id="4-1-连接表达式"><a href="#4-1-连接表达式" class="headerlink" title="4.1 连接表达式"></a>4.1 连接表达式</h2><ul>
<li><strong>定义：</strong> 连接操作接受两个关系，并返回结果作为另一个关系。</li>
<li><strong>定义：</strong> 连接操作是一种笛卡尔积，要求两个关系中的元组相匹配。</li>
<li>连接结果中的属性来源于：笛卡尔积 ✕ + 选择 ✔</li>
<li><strong>定义：连接条件</strong> – 定义两个关系中的哪些元组相匹配，以及结果中存在哪些属性。</li>
<li><strong>定义：连接类型</strong> – 定义如何处理每个关系中不与另一个关系中任何元组匹配的元组。</li>
</ul>
<table>
<thead>
<tr>
<th align="left">连接类型</th>
<th align="left">连接条件</th>
</tr>
</thead>
<tbody><tr>
<td align="left">内连接</td>
<td align="left">natural</td>
</tr>
<tr>
<td align="left">左外连接</td>
<td align="left">on &lt;谓词&gt;</td>
</tr>
<tr>
<td align="left">右外连接</td>
<td align="left">using ((A_1, A_2, \ldots, A_n))</td>
</tr>
<tr>
<td align="left">全外连接</td>
<td align="left"></td>
</tr>
</tbody></table>
<h3 id="1-自然连接操作"><a href="#1-自然连接操作" class="headerlink" title="(1) 自然连接操作"></a>(1) 自然连接操作</h3><p>考虑两个关系：</p>
<ul>
<li><p><strong>course</strong> (课程表)</p>
<table>
<thead>
<tr>
<th>course_id</th>
<th>title</th>
<th>dept_name</th>
<th>credits</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
</tr>
<tr>
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
</tr>
<tr>
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
</tr>
</tbody></table>
</li>
<li><p><strong>prereq</strong> (先修课表)</p>
<table>
<thead>
<tr>
<th>course_id</th>
<th>prereq_id</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>BIO-101</td>
</tr>
<tr>
<td>CS-190</td>
<td>CS-101</td>
</tr>
</tbody></table>
</li>
<li><p><strong>查询1：</strong> <code>select * from course natural join prereq</code></p>
</li>
<li><p><strong>查询2：</strong> <code>select * from course join prereq on course.course_id = prereq.course_id</code></p>
</li>
</ul>
<p><strong>course natural join prereq on course_id</strong> 的结果：</p>
<ul>
<li><em>CS-315的课程信息缺失</em>（因为prereq中没有CS-315）</li>
<li><em>CS-437的先修课信息缺失</em>（因为course中没有CS-437）</li>
</ul>
<table>
<thead>
<tr>
<th>course_id</th>
<th>title</th>
<th>dept_name</th>
<th>credits</th>
<th>prereq_id</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
</tr>
<tr>
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
</tr>
</tbody></table>
<h3 id="2-外连接"><a href="#2-外连接" class="headerlink" title="(2) 外连接"></a>(2) 外连接</h3><ul>
<li><strong>定义：</strong> <strong>连接</strong>操作的扩展，用于避免信息丢失。</li>
<li>计算连接，然后将一个关系中不与另一个关系中任何元组匹配的元组添加到<strong>连接</strong>结果中。</li>
<li><strong>使用空值（null）。</strong></li>
</ul>
<h4 id="1-左外连接"><a href="#1-左外连接" class="headerlink" title="1. 左外连接"></a>1. 左外连接</h4><ul>
<li><code>course natural left outer join prereq</code></li>
</ul>
<table>
<thead>
<tr>
<th>course_id</th>
<th>title</th>
<th>dept_name</th>
<th>credits</th>
<th>prereq_id</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
</tr>
<tr>
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
</tr>
<tr>
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
<td>null</td>
</tr>
</tbody></table>
<ul>
<li><code>select * from course natural left outer join prereq</code></li>
</ul>
<h4 id="2-右外连接"><a href="#2-右外连接" class="headerlink" title="2. 右外连接"></a>2. 右外连接</h4><ul>
<li><code>course natural right outer join prereq</code></li>
</ul>
<table>
<thead>
<tr>
<th>course_id</th>
<th>title</th>
<th>dept_name</th>
<th>credits</th>
<th>prereq_id</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
</tr>
<tr>
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
</tr>
<tr>
<td>CS-347</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>CS-101</td>
</tr>
</tbody></table>
<ul>
<li><code>select * from course natural right outer join prereq</code></li>
</ul>
<h4 id="3-全外连接"><a href="#3-全外连接" class="headerlink" title="3. 全外连接"></a>3. 全外连接</h4><ul>
<li><code>select * from course natural full outer join prereq</code></li>
</ul>
<table>
<thead>
<tr>
<th>course_id</th>
<th>title</th>
<th>dept_name</th>
<th>credits</th>
<th>prereq_id</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
</tr>
<tr>
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
</tr>
<tr>
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
<td>null</td>
</tr>
<tr>
<td>CS-347</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>CS-101</td>
</tr>
</tbody></table>
<h3 id="连接关系-–-示例"><a href="#连接关系-–-示例" class="headerlink" title="连接关系 – 示例"></a>连接关系 – 示例</h3><ul>
<li><p><strong>内连接与自然连接的区别</strong></p>
<ul>
<li><p><code>course inner join prereq on course.course_id = prereq.course_id</code></p>
<table>
<thead>
<tr>
<th>course.course_id</th>
<th>title</th>
<th>dept_name</th>
<th>credits</th>
<th>prereq_id</th>
<th>prereq.course_id</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
<td>BIO-301</td>
</tr>
<tr>
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
<td>CS-190</td>
</tr>
</tbody></table>
</li>
<li><p><code>course left outer join prereq on course.course_id = prereq.course_id</code></p>
<table>
<thead>
<tr>
<th>course.course_id</th>
<th>title</th>
<th>dept_name</th>
<th>credits</th>
<th>prereq_id</th>
<th>prereq.course_id</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
<td>BIO-301</td>
</tr>
<tr>
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
<td>CS-190</td>
</tr>
<tr>
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
<td>null</td>
<td>null</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p><code>course natural right outer join prereq</code></p>
<table>
<thead>
<tr>
<th>course_id</th>
<th>title</th>
<th>dept_name</th>
<th>credits</th>
<th>prereq_id</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
</tr>
<tr>
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
</tr>
<tr>
<td>CS-347</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>CS-101</td>
</tr>
</tbody></table>
</li>
<li><p><code>course full outer join prereq using (course_id)</code></p>
<table>
<thead>
<tr>
<th>course_id</th>
<th>title</th>
<th>dept_name</th>
<th>credits</th>
<th>prereq_id</th>
</tr>
</thead>
<tbody><tr>
<td>BIO-301</td>
<td>Genetics</td>
<td>Biology</td>
<td>4</td>
<td>BIO-101</td>
</tr>
<tr>
<td>CS-190</td>
<td>Game Design</td>
<td>Comp. Sci.</td>
<td>4</td>
<td>CS-101</td>
</tr>
<tr>
<td>CS-315</td>
<td>Robotics</td>
<td>Comp. Sci.</td>
<td>3</td>
<td>null</td>
</tr>
<tr>
<td>CS-347</td>
<td>null</td>
<td>null</td>
<td>null</td>
<td>CS-101</td>
</tr>
</tbody></table>
</li>
</ul>
<hr>
<h2 id="4-2-视图"><a href="#4-2-视图" class="headerlink" title="4.2 视图"></a>4.2 视图</h2><ul>
<li>并非所有用户都希望看到整个逻辑模型。<ul>
<li>例如，某人需要知道教师的姓名和所在系，但不需要知道其工资。</li>
<li>可以查看一个关系：<code>select ID, name, dept_name from instructor</code></li>
</ul>
</li>
<li><strong>定义：</strong> 任何<strong>不属于</strong> <strong>概念</strong>模型，但作为虚拟关系对用户<strong>可见</strong>的关系。</li>
<li>视图对某些用户隐藏了某些数据。</li>
</ul>
<h3 id="视图定义"><a href="#视图定义" class="headerlink" title="视图定义"></a>视图定义</h3><ul>
<li><strong>注意：</strong> 视图 &#x3D; 对一个或多个关系的投影。</li>
<li>视图作为虚拟表存在。</li>
<li><strong>注意：</strong> 视图被称为虚拟关系&#x2F;表。<ul>
<li>只有视图的定义存储在数据库系统中，视图的元组存储在基础关系中。</li>
<li>视图的求值被归结为定义该视图的关系代数表达式的求值。</li>
</ul>
</li>
<li><strong>注意：</strong> <em>with</em>子句和<em>create view</em>子句的区别。<ul>
<li>with子句创建一个临时表来存储查询结果，创建的临时表在SQL执行结束后被取消。</li>
</ul>
</li>
<li><strong>定义：物化视图</strong><ul>
<li>视图的定义和数据都存储在数据库系统中。</li>
</ul>
</li>
</ul>
<h3 id="视图定义语句"><a href="#视图定义语句" class="headerlink" title="视图定义语句"></a>视图定义语句</h3><ul>
<li><strong>定义：</strong> 使用 <strong>create view</strong> 语句定义视图。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> V <span class="keyword">as</span> <span class="operator">&lt;</span>查询表达式<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
其中 <code>&lt;查询表达式&gt;</code> 是SQL表达式。视图名称用 <code>V</code> 表示。</li>
<li>视图名称可用于引用该虚拟表。</li>
<li>视图定义与创建新关系不同。</li>
<li>视图定义导致保存一个表达式。</li>
</ul>
<h3 id="视图示例"><a href="#视图示例" class="headerlink" title="视图示例"></a>视图示例</h3><ul>
<li><p><strong>不包含工资的教师视图</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> faculty <span class="keyword">as</span></span><br><span class="line">  <span class="keyword">select</span> ID, name, dept_name</span><br><span class="line">  <span class="keyword">from</span> instructor</span><br></pre></td></tr></table></figure>
<ul>
<li>查找<em>Biology</em>系的所有教师：</li>
</ul>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name</span><br><span class="line"><span class="keyword">from</span> faculty</span><br><span class="line"><span class="keyword">where</span> dept_name <span class="operator">=</span> <span class="string">&#x27;Biology&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>部门工资总额视图</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> departments_total_salary (dept_name, total_salary) <span class="keyword">as</span></span><br><span class="line">  <span class="keyword">select</span> dept_name, <span class="built_in">sum</span>(salary)</span><br><span class="line">  <span class="keyword">from</span> instructor</span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> dept_name</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="使用其他视图定义的视图"><a href="#使用其他视图定义的视图" class="headerlink" title="使用其他视图定义的视图"></a>使用其他视图定义的视图</h3><ol>
<li>创建 <code>physics_fall_2019</code> 视图：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> physics_fall_2019 <span class="keyword">as</span></span><br><span class="line">  <span class="keyword">select</span> course.course_id, sec_id, building, room_number</span><br><span class="line">  <span class="keyword">from</span> course, section</span><br><span class="line">  <span class="keyword">where</span> course.course_id <span class="operator">=</span> section.course_id</span><br><span class="line">    <span class="keyword">and</span> course.dept_name <span class="operator">=</span> <span class="string">&#x27;Physics&#x27;</span></span><br><span class="line">    <span class="keyword">and</span> section.semester <span class="operator">=</span> <span class="string">&#x27;Fall&#x27;</span></span><br><span class="line">    <span class="keyword">and</span> section.year <span class="operator">=</span> <span class="string">&#x27;2019&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li>基于 <code>physics_fall_2019</code> 创建 <code>physics_fall_2019_watson</code> 视图：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> physics_fall_2019_watson <span class="keyword">as</span></span><br><span class="line">  <span class="keyword">select</span> course_id, room_number</span><br><span class="line">  <span class="keyword">from</span> physics_fall_2019</span><br><span class="line">  <span class="keyword">where</span> building <span class="operator">=</span> <span class="string">&#x27;Watson&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><strong>注意：</strong> 一个视图可以用于定义另一个视图的表达式。<ul>
<li><strong>定义：</strong> 如果视图关系 ( v_2 ) 用于定义视图关系 ( v_1 ) 的表达式中，则称 ( v_1 ) <strong>直接依赖于</strong> ( v_2 )。</li>
<li><strong>定义：</strong> 如果 ( v_1 ) 直接依赖于 ( v_2 )，或者存在从 ( v_1 ) 到 ( v_2 ) 的依赖路径，则称视图关系 ( v_1 ) <strong>依赖于</strong> 视图关系 ( v_2 )。</li>
<li><strong>定义：</strong> 如果视图关系 ( v ) 依赖于自身，则称其为<strong>递归的</strong>。</li>
</ul>
</li>
</ul>
<h3 id="视图展开"><a href="#视图展开" class="headerlink" title="视图展开"></a>视图展开</h3><p>展开查询或另一个视图中对视图的使用。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> physics_fall_2009_watson <span class="keyword">as</span></span><br><span class="line">  <span class="keyword">select</span> course_id, room_number</span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> course.course_id, building, room_number</span><br><span class="line">        <span class="keyword">from</span> course, section</span><br><span class="line">        <span class="keyword">where</span> course.course_id <span class="operator">=</span> section.course_id</span><br><span class="line">          <span class="keyword">and</span> course.dept_name <span class="operator">=</span> <span class="string">&#x27;Physics&#x27;</span></span><br><span class="line">          <span class="keyword">and</span> section.semester <span class="operator">=</span> <span class="string">&#x27;Fall&#x27;</span></span><br><span class="line">          <span class="keyword">and</span> section.year <span class="operator">=</span> <span class="string">&#x27;2009&#x27;</span>)</span><br><span class="line">  <span class="keyword">where</span> building <span class="operator">=</span> <span class="string">&#x27;Watson&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="视图的更新"><a href="#视图的更新" class="headerlink" title="视图的更新"></a>视图的更新</h3><p>向 <code>faculty</code> 视图中插入新元组：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> faculty <span class="keyword">values</span> (<span class="string">&#x27;30765&#x27;</span>, <span class="string">&#x27;Green&#x27;</span>, <span class="string">&#x27;Music&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>此插入操作必须表示为向 <code>instructor</code> 关系中插入元组：<br><code>(&#39;30765&#39;, &#39;Green&#39;, &#39;Music&#39;, null)</code>。</p>
<hr>
<h2 id="4-3-事务"><a href="#4-3-事务" class="headerlink" title="4.3 事务"></a>4.3 事务</h2><ul>
<li><strong>定义：</strong> <strong>事务</strong>由一系列查询和&#x2F;或更新语句组成，它是一个工作<strong>单元</strong>。</li>
<li><strong>注意：</strong> ACID属性<ul>
<li>原子性、一致性、隔离性、持久性。</li>
<li>原子事务：要么完全执行，要么完全回滚，就像从未发生过一样。</li>
<li>与并发事务<strong>隔离</strong>。</li>
</ul>
</li>
<li><strong>注意：</strong> 当事务语句执行时，事务<strong>隐式</strong>开始。事务以以下语句结束：<ul>
<li><strong>Commit work.</strong> 更新永久生效。</li>
<li><strong>Rollback work.</strong> 所有已执行的更新被撤销。</li>
</ul>
</li>
</ul>
<h3 id="事务示例：银行账户转账"><a href="#事务示例：银行账户转账" class="headerlink" title="事务示例：银行账户转账"></a>事务示例：银行账户转账</h3><ul>
<li>初始状态：A&#x3D;1000，B&#x3D;2000，A+B&#x3D;3000</li>
<li>转账操作：A &#x3D; A - 50 &#x3D; 950；B &#x3D; B + 50 &#x3D; 2050；A+B &#x3D; 3000</li>
</ul>
<h3 id="T-SQL-事务示例"><a href="#T-SQL-事务示例" class="headerlink" title="T-SQL 事务示例"></a>T-SQL 事务示例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> <span class="variable">@transfer_name</span> <span class="type">varchar</span>(<span class="number">10</span>)    <span class="comment">/* 事务变量定义 */</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@transfer_name</span> <span class="operator">=</span> <span class="string">&#x27;t-transfer-from-A-to-B&#x27;</span>    <span class="comment">/* 事务命名 */</span></span><br><span class="line"><span class="keyword">BEGIN</span> TRANSACTION <span class="variable">@transfer_name</span>    <span class="comment">/* 事务开始 */</span></span><br><span class="line">USE ACCOUNT    <span class="comment">/* 打开数据库 ACCOUNT */</span></span><br><span class="line">GO    <span class="comment">/* 将上述批 SQL 语句提交 SQL Server */</span></span><br><span class="line"><span class="keyword">UPDATE</span> A    <span class="comment">/* 修改 A 帐户 */</span></span><br><span class="line"><span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">50</span></span><br><span class="line"><span class="keyword">WHERE</span> branch_name <span class="operator">=</span> <span class="string">&#x27;Brooklyn&#x27;</span></span><br><span class="line"><span class="keyword">UPDATE</span> B    <span class="comment">/* 修改 B 帐户 */</span></span><br><span class="line"><span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">50</span></span><br><span class="line"><span class="keyword">WHERE</span> branch_name <span class="operator">=</span> <span class="string">&#x27;Brooklyn&#x27;</span></span><br><span class="line">GO</span><br><span class="line"><span class="keyword">COMMIT</span> TRANSACTION <span class="variable">@transfer_name</span>    <span class="comment">/* 事务提交 */</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-4-完整性约束"><a href="#4-4-完整性约束" class="headerlink" title="4.4 完整性约束"></a>4.4 完整性约束</h2><ul>
<li><strong>定义：</strong> 完整性约束防止数据库遭受意外破坏，确保对数据库的授权更改不会导致数据一致性的丢失。<ul>
<li>教师姓名不能为空。</li>
<li>任意两个教师不能有相同的教师ID。</li>
<li><code>course</code> 关系中的每个系名必须在 <code>department</code> 关系中有匹配的系名。</li>
</ul>
</li>
</ul>
<h3 id="完整性约束分类"><a href="#完整性约束分类" class="headerlink" title="完整性约束分类"></a>完整性约束分类</h3><table>
<thead>
<tr>
<th align="left">类型</th>
<th align="left">属性级</th>
<th align="left">元组级</th>
<th align="left">关系级</th>
</tr>
</thead>
<tbody><tr>
<td align="left">静态</td>
<td align="left">数据类型、数据格式、域约束、空值</td>
<td align="left">属性值间的约束，例如：映射基数约束</td>
<td align="left">实体完整性、参照完整性、函数依赖</td>
</tr>
<tr>
<td align="left">动态</td>
<td align="left">属性值或属性定义更新的约束</td>
<td align="left">属性值间的约束（例如：新旧值关系）</td>
<td align="left">事务约束：原子性、一致性、隔离性、持久性</td>
</tr>
</tbody></table>
<h3 id="完整性约束示例"><a href="#完整性约束示例" class="headerlink" title="完整性约束示例"></a>完整性约束示例</h3><ul>
<li><strong>例1：</strong> <code>Employee</code> 表中经理的工资不应低于1000美元。</li>
<li><strong>例2：</strong> 表 T (x, y, z)，其中 z &#x3D; x + y，z是从x和y派生的属性。</li>
<li><strong>例3：</strong> <code>student</code> 表中的学号不应为空。</li>
<li><strong>例4：</strong> 学生的年龄只能增加。</li>
<li><strong>例5：</strong> 当修改<code>employee</code>元组时，新工资需满足 <code>new.sal &gt; old.sal + 0.5 * age</code>。</li>
<li><strong>例6：</strong> 统计约束。在表中，经理的工资应该是工人工资的四倍以上。</li>
</ul>
<h3 id="单关系上的约束"><a href="#单关系上的约束" class="headerlink" title="单关系上的约束"></a>单关系上的约束</h3><ul>
<li>使用 <strong>create table</strong> 命令定义关系：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> r (A1 D1, A2 D2, ..., An Dn,</span><br><span class="line">                (integrity<span class="operator">-</span>constraint1),</span><br><span class="line">                ...,</span><br><span class="line">                (integrity<span class="operator">-</span>constraintk))</span><br></pre></td></tr></table></figure>
<ul>
<li><code>r</code> 是关系名。</li>
<li>每个 <code>Ai</code> 是关系 <code>r</code> 模式中的一个属性名。</li>
<li><code>Di</code> 是属性 <code>Ai</code> 域中值的数据类型。</li>
</ul>
</li>
<li><strong>注意：</strong> 完整性约束包括：<ul>
<li>primary key</li>
<li>not null</li>
<li>unique</li>
<li>check (P)，其中 <code>P</code> 是一个谓词。</li>
</ul>
</li>
</ul>
<h4 id="Not-Null-约束"><a href="#Not-Null-约束" class="headerlink" title="Not Null 约束"></a>Not Null 约束</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not null</span></span><br><span class="line">budget <span class="type">numeric</span>(<span class="number">12</span>,<span class="number">2</span>) <span class="keyword">not null</span></span><br></pre></td></tr></table></figure>

<h4 id="Unique-约束"><a href="#Unique-约束" class="headerlink" title="Unique 约束"></a>Unique 约束</h4><ul>
<li><strong>定义：</strong> Unique 约束形式如下：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unique</span> (A1, A2, ..., Am)</span><br></pre></td></tr></table></figure>
<ul>
<li>属性 <code>A1, A2, ..., Am</code> 构成一个候选码。</li>
<li>允许候选码为空（与主键不同）。</li>
<li>示例：</li>
</ul>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> customer (</span><br><span class="line">  customer_id <span class="type">char</span>(<span class="number">15</span>),</span><br><span class="line">  customer_name <span class="type">char</span>(<span class="number">15</span>),</span><br><span class="line">  customer_city <span class="type">char</span>(<span class="number">30</span>),</span><br><span class="line">  <span class="keyword">primary key</span> (customer_id),</span><br><span class="line">  <span class="keyword">unique</span> (customer_name)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Check-子句"><a href="#Check-子句" class="headerlink" title="Check 子句"></a>Check 子句</h4><ul>
<li>应用于关系声明和域声明。</li>
<li><code>check (P)</code>，其中 <code>P</code> 是一个谓词。</li>
<li>示例：确保 <code>semester</code> 属性值在 {‘Fall’, ‘Winter’, ‘Spring’, ‘Summer’} 中。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> section (</span><br><span class="line">  course_id <span class="type">varchar</span>(<span class="number">8</span>),</span><br><span class="line">  sec_id <span class="type">varchar</span>(<span class="number">8</span>),</span><br><span class="line">  semester <span class="type">varchar</span>(<span class="number">6</span>),</span><br><span class="line">  <span class="keyword">year</span> <span class="type">numeric</span>(<span class="number">4</span>,<span class="number">0</span>),</span><br><span class="line">  room_number <span class="type">varchar</span>(<span class="number">7</span>),</span><br><span class="line">  <span class="keyword">primary key</span> (course_id, sec_id, semester, <span class="keyword">year</span>),</span><br><span class="line">  <span class="keyword">check</span> (semester <span class="keyword">in</span> (<span class="string">&#x27;Fall&#x27;</span>, <span class="string">&#x27;Winter&#x27;</span>, <span class="string">&#x27;Spring&#x27;</span>, <span class="string">&#x27;Summer&#x27;</span>))</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="参照完整性"><a href="#参照完整性" class="headerlink" title="参照完整性"></a>参照完整性</h3><ul>
<li><strong>参照完整性</strong><ul>
<li><strong>确保</strong>在一个关系的给定属性（外键）上出现的值，也出现在另一个关系的对应属性（主键）上。</li>
<li>如果 <code>Biology</code> 是出现在 <code>instructor</code> 关系元组中的一个系名，那么 <code>department</code> 关系中必须存在 <code>Biology</code> 的元组。</li>
</ul>
</li>
</ul>
<h4 id="参照完整性依赖"><a href="#参照完整性依赖" class="headerlink" title="参照完整性依赖"></a>参照完整性依赖</h4><ul>
<li><strong>定义：</strong> 设 ( r_1(R_1) ) 和 ( r_2(R_2) ) 是分别具有主键 ( K_1 ) 和 ( K_2 ) 的关系。<ul>
<li>例如：<br>  ( r_1: \text{department(dept_name, building, budget)} )<br>  ( r_2: \text{course(course_id, title, dept_name, credits)} )</li>
</ul>
</li>
<li>( R_2 ) 的子集 ( \alpha )（例如 dept_name）是一个<strong>外键</strong>（来自 ( r_2 )，<strong>course</strong>），引用关系 ( r_1 )（<strong>department</strong>）中的 ( K_1 )，如果对于 ( r_2 ) 中的每个元组 ( t_2 )，在 ( r_1 ) 中必须存在一个元组 ( t_1 )，使得 ( t_1[K_1] &#x3D; t_2[\alpha] )。</li>
<li><strong>注意：</strong> ( \alpha &#x3D; K_1 \subseteq R_2 )</li>
<li><strong>定义：</strong> 参照完整性约束被称为<strong>子集依赖</strong>，因为它可以写成：<br>( \prod_{\alpha}(r_2) \subseteq \prod_{K_1}(r_1) )<ul>
<li>例如：( \prod_{dept_name} (course) \subseteq \prod_{dept_name} (department) )</li>
</ul>
</li>
<li>表 ( r_2 ) 的外键 ( \alpha ) 引用被引用表 ( r_1 ) 的主键属性 ( K_1 )。</li>
<li><strong>注意：</strong> 良好的数据库设计应确保任何关系模式 ( R_2 ) 只能通过其外键引用其他关系模式 ( R_1 )。</li>
</ul>
<h3 id="参照完整性声明"><a href="#参照完整性声明" class="headerlink" title="参照完整性声明"></a>参照完整性声明</h3><ul>
<li>主键、候选键和外键可以在 <strong>create table</strong> 语句中指定：<ul>
<li><strong>primary key</strong> 子句列出构成主键的属性。</li>
<li><strong>unique</strong> 子句列出构成候选键的属性。</li>
<li><strong>foreign key</strong> 子句列出构成外键的属性以及外键引用的关系名。</li>
<li>外键引用被引用表的主键属性。</li>
</ul>
</li>
</ul>
<h3 id="参照完整性中的级联操作"><a href="#参照完整性中的级联操作" class="headerlink" title="参照完整性中的级联操作"></a>参照完整性中的级联操作</h3><ul>
<li><strong>简略声明：</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> course (</span><br><span class="line">  course_id <span class="type">char</span>(<span class="number">5</span>) <span class="keyword">primary key</span>,</span><br><span class="line">  title <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">  dept_name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">references</span> department</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
<li><strong>详细声明（支持级联）：</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> course (</span><br><span class="line">  ...</span><br><span class="line">  dept_name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">  <span class="keyword">foreign key</span> (dept_name) <span class="keyword">references</span> department</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> cascade</span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> cascade,</span><br><span class="line">  ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
<li>级联的替代操作：set null, set default。</li>
<li>对被引用表 <code>department</code> 的删除&#x2F;更新操作将导致对引用表 <code>course</code> 的级联删除&#x2F;更新。</li>
</ul>
<h3 id="事务期间的完整性约束违反"><a href="#事务期间的完整性约束违反" class="headerlink" title="事务期间的完整性约束违反"></a>事务期间的完整性约束违反</h3><ul>
<li>示例：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> person (</span><br><span class="line">  ID <span class="type">char</span>(<span class="number">10</span>),</span><br><span class="line">  name <span class="type">char</span>(<span class="number">40</span>),</span><br><span class="line">  mother <span class="type">char</span>(<span class="number">10</span>),</span><br><span class="line">  father <span class="type">char</span>(<span class="number">10</span>),</span><br><span class="line">  <span class="keyword">primary key</span> (ID),</span><br><span class="line">  <span class="keyword">foreign key</span> (father) <span class="keyword">references</span> person(ID),</span><br><span class="line">  <span class="keyword">foreign key</span> (mother) <span class="keyword">references</span> person(ID)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
<li><strong>如何在具有主键-外键关联的两个表上修改数据？</strong></li>
<li><strong>如何插入元组而不引起约束违反？</strong><ul>
<li>在插入 <code>person</code> 之前先插入该人的父亲和母亲。</li>
<li>或者，先将 <code>father</code> 和 <code>mother</code> 设置为 <code>null</code>，在插入所有人之后再更新（如果 <code>father</code> 和 <code>mother</code> 属性声明为 <code>not null</code> 则不可行）。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="4-5-数据类型和模式"><a href="#4-5-数据类型和模式" class="headerlink" title="4.5 数据类型和模式"></a>4.5 数据类型和模式</h2><h3 id="内置数据类型"><a href="#内置数据类型" class="headerlink" title="内置数据类型"></a>内置数据类型</h3><ul>
<li><strong>date：</strong> 日期，包含（4位）年、月、日。<ul>
<li>例如：<code>date &#39;2017-7-27&#39;</code></li>
</ul>
</li>
<li><strong>time：</strong> 一天中的时间，时、分、秒。<ul>
<li>例如：<code>time &#39;09:00:30.75&#39;</code></li>
</ul>
</li>
<li><strong>timestamp：</strong> 日期 + 一天中的时间。<ul>
<li>例如：<code>timestamp &#39;2017-7-27 09:00:30.75&#39;</code></li>
</ul>
</li>
<li><strong>interval：</strong> 时间段。<ul>
<li>如果 x 和 y 是 date 类型，那么 <code>x - y</code> 是一个 interval，其值是从日期 x 到日期 y 的天数。</li>
<li>例如：<code>interval &#39;1 day&#39; = &#39;2017-7-28&#39; – &#39;2017-7-27&#39;</code></li>
</ul>
</li>
</ul>
<h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><ul>
<li><strong><code>cast(e as t)</code></strong><ul>
<li>将字符串 <code>e</code> 转换为类型 <code>t</code>。</li>
<li>例如：<code>cast(&#39;2017-07-20&#39; as date)</code></li>
<li>例如：<code>cast(&#39;09:00:30.75&#39; as time)</code></li>
<li><pre><code class="language-sql">select cast(ID as numeric(5)) as inst_id
from instructor
order by inst_id
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">*   从日期或时间值中提取部分。</span><br><span class="line">*   对于日期或时间值 `d`，可以提取其各个字段。</span><br><span class="line">    *   例如：`extract(year from date &#x27;2017-07-20&#x27;) = 2017`</span><br><span class="line">    *   例如：`extract(timezone_hour from timestamp &#x27;2017-7-27 09:00:30.75&#x27;) = 09`</span><br><span class="line"></span><br><span class="line">### CAST/CONVERT 用于数据类型转换示例</span><br><span class="line"></span><br><span class="line">#### A. 同时使用 CAST 和 CONVERT</span><br><span class="line">每个示例都检索列表价格第一位是3的产品名称，并将 ListPrice 转换为 int。</span><br><span class="line">```sql</span><br><span class="line">-- 使用 CAST</span><br><span class="line">USE AdventureWorks;</span><br><span class="line">GO</span><br><span class="line">SELECT SUBSTRING(Name, 1, 30) AS ProductName, ListPrice</span><br><span class="line">FROM Production.Product</span><br><span class="line">WHERE CAST(ListPrice AS int) LIKE &#x27;3%&#x27;;</span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line">-- 使用 CONVERT</span><br><span class="line">USE AdventureWorks;</span><br><span class="line">GO</span><br><span class="line">SELECT SUBSTRING(Name, 1, 30) AS ProductName, ListPrice</span><br><span class="line">FROM Production.Product</span><br><span class="line">WHERE CONVERT(int, ListPrice) LIKE &#x27;3%&#x27;;</span><br><span class="line">GO</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 id="B-使用包含算术运算符的-CAST"><a href="#B-使用包含算术运算符的-CAST" class="headerlink" title="B. 使用包含算术运算符的 CAST"></a>B. 使用包含算术运算符的 CAST</h4><p>将销售额除以佣金百分比，结果四舍五入到最接近的整数后转换为 int。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE AdventureWorks;</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CAST</span>(ROUND(SalesYTD<span class="operator">/</span>CommissionPCT, <span class="number">0</span>) <span class="keyword">AS</span> <span class="type">int</span>) <span class="keyword">AS</span> <span class="string">&#x27;Computed&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> Sales.SalesPerson</span><br><span class="line"><span class="keyword">WHERE</span> CommissionPCT <span class="operator">!=</span> <span class="number">0</span>;</span><br><span class="line">GO</span><br></pre></td></tr></table></figure>

<h4 id="C-使用-CAST-进行连接"><a href="#C-使用-CAST-进行连接" class="headerlink" title="C. 使用 CAST 进行连接"></a>C. 使用 CAST 进行连接</h4><p>使用 CAST 连接非字符非二进制表达式。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE AdventureWorks;</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;The list price is &#x27;</span> <span class="operator">+</span> <span class="built_in">CAST</span>(ListPrice <span class="keyword">AS</span> <span class="type">varchar</span>(<span class="number">12</span>)) <span class="keyword">AS</span> ListPrice</span><br><span class="line"><span class="keyword">FROM</span> Production.Product</span><br><span class="line"><span class="keyword">WHERE</span> ListPrice <span class="keyword">BETWEEN</span> <span class="number">350.00</span> <span class="keyword">AND</span> <span class="number">400.00</span>;</span><br><span class="line">GO</span><br></pre></td></tr></table></figure>

<h4 id="D-使用-CAST-生成可读性更高的文本"><a href="#D-使用-CAST-生成可读性更高的文本" class="headerlink" title="D. 使用 CAST 生成可读性更高的文本"></a>D. 使用 CAST 生成可读性更高的文本</h4><p>使用 CAST 将 Name 列转换为 char(10) 列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE AdventureWorks;</span><br><span class="line">GO</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> <span class="built_in">CAST</span>(p.Name <span class="keyword">AS</span> <span class="type">char</span>(<span class="number">10</span>)) <span class="keyword">AS</span> Name, s.UnitPrice</span><br><span class="line"><span class="keyword">FROM</span> Sales.SalesOrderDetail s <span class="keyword">JOIN</span> Production.Product p <span class="keyword">on</span> s.ProductID <span class="operator">=</span> p.ProductID</span><br><span class="line"><span class="keyword">WHERE</span> Name <span class="keyword">LIKE</span> <span class="string">&#x27;Long-Sleeve Logo Jersey, M&#x27;</span>;</span><br><span class="line">GO</span><br></pre></td></tr></table></figure>

<h3 id="默认值"><a href="#默认值" class="headerlink" title="默认值"></a>默认值</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> student (</span><br><span class="line">  ID <span class="type">varchar</span>(<span class="number">5</span>),</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not null</span>,</span><br><span class="line">  dept_name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">  tot_cred <span class="type">numeric</span>(<span class="number">3</span>,<span class="number">0</span>) <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line">  <span class="keyword">primary key</span> (ID)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>插入数据时，未指定 <code>tot_cred</code> 则使用默认值0：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert into</span> student(ID, name, dept_name) <span class="keyword">values</span> (<span class="string">&#x27;12789&#x27;</span>, <span class="string">&#x27;Newman&#x27;</span>, <span class="string">&#x27;Comp.Sci&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="用户定义类型"><a href="#用户定义类型" class="headerlink" title="用户定义类型"></a>用户定义类型</h3><ul>
<li>使用 <code>create type</code> 子句定义用户定义类型。<ul>
<li>示例：<code>create type Dollars as numeric(12,2)</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> department (</span><br><span class="line">  dept_name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">  building <span class="type">varchar</span>(<span class="number">15</span>),</span><br><span class="line">  budget Dollars</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
<li>使用 <code>cast</code> 将一个类型的值转换为另一个域。<ul>
<li>例如，<code>cast(department.budget to numeric(12,2))</code>，然后表达式 <code>(department.budget + 20)</code> 可以被求值。</li>
</ul>
</li>
</ul>
<h3 id="用户定义域"><a href="#用户定义域" class="headerlink" title="用户定义域"></a>用户定义域</h3><ul>
<li><code>create domain</code> 构造创建用户定义的域类型。<ul>
<li><code>create domain person_name char(20) not null</code></li>
</ul>
</li>
<li>类型和域相似。域可以指定约束，例如 <code>not null</code>。</li>
<li>示例：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> domain degree_level <span class="type">varchar</span>(<span class="number">10</span>)</span><br><span class="line">  <span class="keyword">constraint</span> degree_level_test</span><br><span class="line">  <span class="keyword">check</span> (<span class="keyword">value</span> <span class="keyword">in</span> (<span class="string">&#x27;Bachelors&#x27;</span>, <span class="string">&#x27;Masters&#x27;</span>, <span class="string">&#x27;Doctorate&#x27;</span>));</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="复杂检查条件和断言"><a href="#复杂检查条件和断言" class="headerlink" title="复杂检查条件和断言"></a>复杂检查条件和断言</h3><ul>
<li><p>一些构造如 <em>check</em> 和 <em>assertion</em> 被定义为用于指定复杂的完整性约束。</p>
<ul>
<li><strong>但是，目前大多数数据库系统不支持它们。</strong></li>
</ul>
</li>
<li><p><strong>复杂 Check 条件示例：</strong></p>
<ul>
<li>对于关系 <code>section</code>，每个元组中的 <code>time_slot_id</code> 实际上应该是 <code>time_slot</code> 关系中的一个时间槽标识符。此约束可以定义为：</li>
</ul>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">check</span> (time_slot_id <span class="keyword">in</span> (<span class="keyword">select</span> time_slot_id <span class="keyword">from</span> time_slot))</span><br></pre></td></tr></table></figure>
<ul>
<li>在 <code>create table</code> 中使用 <code>check</code>：</li>
</ul>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> student (</span><br><span class="line">  ID <span class="type">varchar</span>(<span class="number">5</span>),</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not null</span>,</span><br><span class="line">  dept_name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">  tot_cred <span class="type">numeric</span>(<span class="number">3</span>,<span class="number">0</span>),</span><br><span class="line">  <span class="keyword">primary key</span> (ID),</span><br><span class="line">  <span class="keyword">foreign key</span> (dept_name) <span class="keyword">references</span> department,</span><br><span class="line">  <span class="keyword">check</span>(tot_cred <span class="operator">&gt;</span> <span class="number">0</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>断言</strong></p>
<ul>
<li>断言是表示我们希望数据库始终满足的条件的谓词。<ul>
<li>例如：域约束、参照完整性约束。</li>
</ul>
</li>
<li>断言的形式：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> assertion <span class="operator">&lt;</span>断言名称<span class="operator">&gt;</span> <span class="keyword">check</span> <span class="operator">&lt;</span>谓词<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><strong>同样不被大多数DBMS（如 SQL Server）支持。为什么？</strong><ul>
<li>当创建断言时，DBMS 测试其有效性。任何对数据库的修改只有在该断言不被违反时才被允许。</li>
<li>这种测试可能引入显著的开销，因此应非常谨慎地使用断言。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>断言示例：</strong></p>
<ul>
<li>对于 <code>student</code> 关系中的每个元组，<code>tot_cred</code> 属性的值必须等于该学生成功完成的课程的学分总和。</li>
</ul>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> assertion credits_earned_constraint <span class="keyword">check</span></span><br><span class="line">  (<span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line">    <span class="keyword">select</span> ID</span><br><span class="line">    <span class="keyword">from</span> student</span><br><span class="line">    <span class="keyword">where</span> tot_cred <span class="operator">&lt;&gt;</span></span><br><span class="line">      (<span class="keyword">select</span> <span class="built_in">sum</span>(credits)</span><br><span class="line">       <span class="keyword">from</span> takes <span class="keyword">natural</span> <span class="keyword">join</span> course</span><br><span class="line">       <span class="keyword">where</span> student.ID <span class="operator">=</span> takes.ID</span><br><span class="line">         <span class="keyword">and</span> grade <span class="keyword">is</span> <span class="keyword">not null</span></span><br><span class="line">         <span class="keyword">and</span> grade <span class="operator">&lt;&gt;</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line">      )</span><br><span class="line">  ))</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="4-6-SQL-中的索引定义"><a href="#4-6-SQL-中的索引定义" class="headerlink" title="4.6 SQL 中的索引定义"></a>4.6 SQL 中的索引定义</h2><ul>
<li>许多查询只引用表中的一小部分记录。</li>
<li>读取每条记录以查找具有特定值的记录是<strong>低效的</strong>。</li>
<li>关系属性上的<strong>索引</strong>是一种数据结构，它允许数据库系统高效地查找关系中在该属性上具有指定值的那些元组，而无需扫描关系的所有元组。</li>
<li>使用 <strong>create index</strong> 命令创建索引：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> index <span class="operator">&lt;</span>索引名<span class="operator">&gt;</span> <span class="keyword">on</span> <span class="operator">&lt;</span>关系名<span class="operator">&gt;</span> (属性);</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="索引定义示例"><a href="#索引定义示例" class="headerlink" title="索引定义示例"></a>索引定义示例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create table</span> student (</span><br><span class="line">  ID <span class="type">varchar</span>(<span class="number">5</span>),</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not null</span>,</span><br><span class="line">  dept_name <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">  tot_cred <span class="type">numeric</span>(<span class="number">3</span>,<span class="number">0</span>) <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line">  <span class="keyword">primary key</span> (ID)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> index studentID_index <span class="keyword">on</span> student(ID);</span><br></pre></td></tr></table></figure>
<p>查询时可以利用索引高效定位记录：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">where</span> ID <span class="operator">=</span> <span class="string">&#x27;12345&#x27;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="4-7-授权"><a href="#4-7-授权" class="headerlink" title="4.7 授权"></a>4.7 授权</h2><h3 id="对数据库部分的授权形式"><a href="#对数据库部分的授权形式" class="headerlink" title="对数据库部分的授权形式"></a>对数据库部分的授权形式</h3><ul>
<li><strong>Read</strong> - 允许读取数据，但不允许修改。</li>
<li><strong>Insert</strong> - 允许插入新数据，但不允许修改现有数据。</li>
<li><strong>Update</strong> - 允许修改数据，但不允许删除。</li>
<li><strong>Delete</strong> - 允许删除数据。</li>
</ul>
<h3 id="对数据库模式修改的授权形式（第8章）"><a href="#对数据库模式修改的授权形式（第8章）" class="headerlink" title="对数据库模式修改的授权形式（第8章）"></a>对数据库模式修改的授权形式（第8章）</h3><ul>
<li><strong>resources</strong> - 允许创建新关系。</li>
<li><strong>alteration</strong> - 允许在关系中添加或删除属性。</li>
<li><strong>drop</strong> - 允许删除关系。</li>
<li><strong>index</strong> - 允许创建和删除索引。</li>
</ul>
<h3 id="授权规范"><a href="#授权规范" class="headerlink" title="授权规范"></a>授权规范</h3><ul>
<li>使用 <strong>grant</strong> 语句授予授权。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="operator">&lt;</span>权限列表<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">on</span> <span class="operator">&lt;</span>关系名或视图名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">to</span> <span class="operator">&lt;</span>用户列表<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>&lt;用户列表&gt;</code> 可以是：用户ID，或 <strong>public</strong>（允许所有有效用户获得授予的权限）。</li>
</ul>
</li>
<li>授予<strong>视图</strong>上的权限并不意味着授予对底层关系的任何权限。</li>
<li>权限的授予者必须已经拥有指定项目上的该权限（或者是数据库管理员）。</li>
</ul>
<h3 id="权限类型"><a href="#权限类型" class="headerlink" title="权限类型"></a>权限类型</h3><ul>
<li><strong>select</strong>：允许读取关系，或使用视图进行查询的能力。<ul>
<li>示例：授予用户 ( U_1, U_2, U_3 ) 对 <code>instructor</code> 关系的 select 授权：</li>
</ul>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> instructor <span class="keyword">to</span> U1, U2, U3</span><br></pre></td></tr></table></figure></li>
<li><strong>insert</strong>：插入元组的能力。</li>
<li><strong>update</strong>：使用 SQL update 语句更新的能力。</li>
<li><strong>delete</strong>：删除元组的能力。</li>
<li><strong>all privileges</strong>：用作所有允许权限的简写形式。</li>
</ul>
<h3 id="撤销授权"><a href="#撤销授权" class="headerlink" title="撤销授权"></a>撤销授权</h3><ul>
<li>使用 <strong>revoke</strong> 语句撤销授权。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">revoke</span> <span class="operator">&lt;</span>权限列表<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">on</span> <span class="operator">&lt;</span>关系名或视图名<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">from</span> <span class="operator">&lt;</span>用户列表<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>示例：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">revoke</span> <span class="keyword">select</span> <span class="keyword">on</span> branch <span class="keyword">from</span> U1, U2, U3</span><br></pre></td></tr></table></figure></li>
<li><code>&lt;权限列表&gt;</code> 可以是 <strong>all</strong>，以撤销撤销者可能持有的所有权限。</li>
<li>如果 <code>&lt;撤销列表&gt;</code> 包含 <strong>public</strong>，则所有用户都会失去该权限，除非他们被明确授予该权限。</li>
</ul>
<h3 id="角色"><a href="#角色" class="headerlink" title="角色"></a>角色</h3><ul>
<li>创建角色：<code>create role instructor;</code></li>
<li>将角色授予用户：<code>grant instructor to Amit;</code></li>
<li>可以向角色授予权限：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> takes <span class="keyword">to</span> instructor;</span><br></pre></td></tr></table></figure></li>
<li>角色可以授予给用户，也可以授予给其他角色：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> role teaching_assistant;</span><br><span class="line"><span class="keyword">grant</span> teaching_assistant <span class="keyword">to</span> instructor;</span><br><span class="line"><span class="comment">-- Instructor 继承 teaching_assistant 的所有权限</span></span><br></pre></td></tr></table></figure></li>
<li>角色链：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> role dean;</span><br><span class="line"><span class="keyword">grant</span> instructor <span class="keyword">to</span> dean;</span><br><span class="line"><span class="keyword">grant</span> dean <span class="keyword">to</span> Satoshi;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="视图上的授权"><a href="#视图上的授权" class="headerlink" title="视图上的授权"></a>视图上的授权</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> geo_instructor <span class="keyword">as</span></span><br><span class="line">  (<span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">   <span class="keyword">from</span> instructor</span><br><span class="line">   <span class="keyword">where</span> dept_name <span class="operator">=</span> <span class="string">&#x27;Geology&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> geo_instructor <span class="keyword">to</span> geo_staff;</span><br></pre></td></tr></table></figure>
<ul>
<li>假设 <code>geo_staff</code> 成员执行：<code>select * from geo_instructor;</code></li>
<li>如果发生以下情况会怎样？<ul>
<li><code>geo_staff</code> 对 <code>instructor</code> 没有权限？</li>
<li>视图创建者对 <code>instructor</code> 没有某些权限？</li>
</ul>
</li>
</ul>
<h3 id="其他授权特性"><a href="#其他授权特性" class="headerlink" title="其他授权特性"></a>其他授权特性</h3><ul>
<li><strong>references</strong> 权限用于创建外键。<ul>
<li><code>grant reference (dept_name) on department to Mariano;</code></li>
<li>为什么需要这个？</li>
</ul>
</li>
<li><strong>权限转移</strong><ul>
<li><code>grant select on department to Amit with grant option;</code></li>
</ul>
</li>
<li><strong>级联撤销</strong><ul>
<li><code>revoke select on department from Amit, Satoshi cascade;</code></li>
</ul>
</li>
<li><strong>限制撤销</strong><ul>
<li><code>revoke select on department from Amit, Satoshi restrict;</code></li>
</ul>
</li>
</ul>
<p><strong>等等。</strong> 更多细节请阅读第4.6节。</p>
<hr>
<h2 id="实验要求与讨论"><a href="#实验要求与讨论" class="headerlink" title="实验要求与讨论"></a>实验要求与讨论</h2><h3 id="实验要求：外键关联与级联操作"><a href="#实验要求：外键关联与级联操作" class="headerlink" title="实验要求：外键关联与级联操作"></a>实验要求：外键关联与级联操作</h3><ul>
<li><strong>平台：</strong> openGauss</li>
<li><strong>任务：</strong> 定义两张表间的无级联修改和有级联修改的外键关联。判断当增&#x2F;删&#x2F;改一张表中的主键、外键值时，DBMS 的反应。</li>
</ul>
<h3 id="数据库系统设计时，是否使用外键？"><a href="#数据库系统设计时，是否使用外键？" class="headerlink" title="数据库系统设计时，是否使用外键？"></a>数据库系统设计时，是否使用外键？</h3><ul>
<li>外键反映了不同数据项间的逻辑关联和约束关系，是一种客观存在。<ul>
<li>例如：<code>department</code> 表和 <code>course</code> 表中的 <code>dept_name</code>。</li>
</ul>
</li>
<li>对外键的处理方式反映了对这种数据相互间关系的处理态度，需要根据实际情况而定，考虑数据完整性、处理效率等多种因素。<ul>
<li>并非简单的“需要外键”或“不设外键”。</li>
</ul>
</li>
</ul>
<h4 id="方式1：设置数据库表的外键"><a href="#方式1：设置数据库表的外键" class="headerlink" title="方式1：设置数据库表的外键"></a>方式1：设置数据库表的外键</h4><ul>
<li><strong>优点</strong><ul>
<li>DBMS 自动维护数据间的关联、约束关系。</li>
</ul>
</li>
<li><strong>缺点</strong><ul>
<li>数据导入、增删改时，多个表间的相互关联保证了数据一致性和完整性，但影响到整体数据处理效率（额外的 DBMS 处理开销）。</li>
<li>例如：插入一条 <code>dept_name</code> 不存在的 <code>course</code> 元组，失败，并影响前面已经成功插入的数据——局部错误影响整体。</li>
</ul>
</li>
</ul>
<h4 id="方式2：不设置外键，由应用程序在业务逻辑层维护数据一致性、完整性"><a href="#方式2：不设置外键，由应用程序在业务逻辑层维护数据一致性、完整性" class="headerlink" title="方式2：不设置外键，由应用程序在业务逻辑层维护数据一致性、完整性"></a>方式2：不设置外键，由应用程序在业务逻辑层维护数据一致性、完整性</h4><ul>
<li><strong>优点</strong><ul>
<li>1）避免局部错误影响整体进度；</li>
<li>2）业务逻辑层的数据一致性处理速度可以比较快，例如将数据提至内存中批量处理。</li>
</ul>
</li>
<li><strong>缺点</strong>：对应用层业务处理程序设计的额外要求。</li>
<li>上述两种方式用在对数据一致性完整性要求高的场景下，例如银行。</li>
</ul>
<h4 id="方式3：不设置外键，业务层应用逻辑也不处理数据间一致性"><a href="#方式3：不设置外键，业务层应用逻辑也不处理数据间一致性" class="headerlink" title="方式3：不设置外键，业务层应用逻辑也不处理数据间一致性"></a>方式3：不设置外键，业务层应用逻辑也不处理数据间一致性</h4><ul>
<li>牺牲数据的正确性，换取数据处理的效率。</li>
<li>例如：大数据应用场景下，对数据精度、正确性要求不高。</li>
</ul>
<h3 id="LTE-网络数据库课程实验讨论"><a href="#LTE-网络数据库课程实验讨论" class="headerlink" title="LTE 网络数据库课程实验讨论"></a>LTE 网络数据库课程实验讨论</h3><ul>
<li><code>tbMRData</code>、<code>tbATUData</code> 表中的主小区、邻小区 ID 对应于 <code>tbCell</code> 中的小区标识 <code>Sector_ID</code>。</li>
<li><strong>实际应用中，不建议</strong>在 <code>tbMRData</code>、<code>tbATUData</code> 与 <code>tbCell</code> 之间建立外键。否则，两表间由于强行的外键约束，可能带来低效的数据处理。<ul>
<li><strong>例1：</strong> 向 <code>tbMRData</code>、<code>tbATUData</code> 中大批量导入数据时，插入的某条测量报告数据中的某些主小区、邻小区没有出现在 <code>tbCell</code> 表中，导致本条以及前面各条已成功插入的测量报告均插入失败。</li>
<li><strong>例2：</strong> 当 <code>tbCell</code> 中某个小区修改名字时，在（数据量非常大，例如 T 级别，上亿条）<code>tbMRData</code>、<code>tbATUData</code> 表中以该小区作为主、邻小区的测量报告也必须随之修改。</li>
</ul>
</li>
<li><strong>现网环境中不一致的原因：</strong><ul>
<li><code>tbMRData</code>、<code>tbATUData</code> 中的测量报告的测量范围超出 <code>tbCell</code> 的范围，有些测量报告的主小区、邻小区没有出现在 <code>tbCell</code> 表中。</li>
<li><code>tbCell</code> 表中的小区数据有可能被修改，导致与 <code>tbMRData</code>、<code>tbATUData</code> 中的测量报告不一致。</li>
</ul>
</li>
</ul>
<h3 id="LTE-网络数据库实验要求"><a href="#LTE-网络数据库实验要求" class="headerlink" title="LTE 网络数据库实验要求"></a>LTE 网络数据库实验要求</h3><ol>
<li>在建表、数据导入阶段，<strong>先不要建立</strong> <code>tbMRData</code>、<code>tbATUData</code> 与 <code>tbCell</code> 间的外键。</li>
<li>数据导入完成后，再建立表间外键关联，观察：<ul>
<li>是否能建立？</li>
<li>如果建立，<code>tbCell</code> 中主键值的变化对 <code>tbMRData</code>、<code>tbATUData</code> 的影响，或反之。</li>
</ul>
</li>
<li>在已建立的表中增加外键的方法，参见具体 DBMS 平台用户手册。</li>
</ol>
<hr>
<h2 id="附录-4-1-T-SQL-中的-CREATE-TABLE"><a href="#附录-4-1-T-SQL-中的-CREATE-TABLE" class="headerlink" title="附录 4-1: T-SQL 中的 CREATE TABLE"></a>附录 4-1: T-SQL 中的 CREATE TABLE</h2><p>（此处详细语法结构图展示了 T-SQL 中 CREATE TABLE 语句的复杂选项，包括列定义、约束、物理存储选项（分区、文件组）、索引类型（聚集&#x2F;非聚集）等，强调了物理设计层面的考量。具体语法细节可参考 SQL Server 文档。）</p>
<hr>
<h2 id="本章内容总结（大纲）"><a href="#本章内容总结（大纲）" class="headerlink" title="本章内容总结（大纲）"></a>本章内容总结（大纲）</h2><p><strong>I. SQL 数据类型和模式 (4.5)</strong></p>
<ul>
<li>日期和时间类型</li>
<li>类型转换和格式化函数</li>
<li>默认值</li>
<li>大对象类型，用户定义类型</li>
<li>create table 扩展，生成唯一键值</li>
<li>模式、目录、环境</li>
</ul>
<p><strong>II. 连接表达式 (4.1) (用于多表访问)</strong></p>
<ul>
<li>自然连接</li>
<li>连接条件</li>
<li>外连接</li>
<li>连接类型和条件</li>
</ul>
<p><strong>III. 视图 (4.2)</strong></p>
<ul>
<li>定义、查询、更新</li>
<li>物化视图</li>
</ul>
<p><strong>IV. 事务 (4.3)</strong></p>
<ul>
<li>定义、示例</li>
</ul>
<p><strong>V. 完整性约束 (4.4)</strong></p>
<ul>
<li>not null, unique, check</li>
<li>参照完整性</li>
<li>复杂检查约束和断言</li>
<li>为约束命名，事务期间的约束违反</li>
</ul>
<p><strong>VI. SQL 中的索引定义 (4.6)</strong></p>
<p><strong>VII. 授权 (4.7)</strong></p>
<ul>
<li>grant&#x2F;revoke, 角色</li>
</ul>
<p><strong>实验：</strong> 完整性约束</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src="/img/my_avatar.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src="/img/my_avatar.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">Yuejin Wu</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/12/24/DB_Intermediate%20SQL/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/12/24/DB_Intermediate%20SQL/')">Intermediate-SQL 解读</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/12/24/DB_Intermediate%20SQL/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Intermediate-SQL 解读&amp;url=http://example.com/2025/12/24/DB_Intermediate%20SQL/&amp;pic=/img/SQL_cover.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Yuejin's Blog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>数据库<span class="categoryesPageCount">6</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Database/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Database<span class="tagsPageCount">6</span></a><a class="post-meta__box__tags" href="/tags/SQL/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>SQL<span class="tagsPageCount">5</span></a></div></div><div class="post_share"><div class="social-share" data-image="/img/C7_cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/12/24/DB_AdvancedSQL/"><img class="prev-cover" src="/img/SQL_cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Advanced-SQL课件详解</div></div></a></div><div class="next-post pull-right"><a href="/2025/12/26/DB_Schema%20Normalization-Relational%20Database%20Design/"><img class="next-cover" src="/img/C7_cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Schema Normalization-Relational Database Design 解读</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/12/22/DB_SQL%20%E8%AF%AD%E8%A8%80%E7%AE%80%E8%AF%BB/" title="Intro-to-SQL 简读"><img class="cover" src="/img/SQL_cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-12-22</div><div class="title">Intro-to-SQL 简读</div></div></a></div><div><a href="/2025/12/26/DB_Schema%20Normalization-Relational%20Database%20Design/" title="Schema Normalization-Relational Database Design 解读"><img class="cover" src="/img/C7_cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-12-26</div><div class="title">Schema Normalization-Relational Database Design 解读</div></div></a></div><div><a href="/2025/12/24/DB_AdvancedSQL/" title="Advanced-SQL课件详解"><img class="cover" src="/img/SQL_cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-12-24</div><div class="title">Advanced-SQL课件详解</div></div></a></div><div><a href="/2025/12/24/DB_%E9%AB%98%E7%BA%A7SQL%E7%AE%80%E8%AF%BB/" title="高级SQL 简读"><img class="cover" src="/img/SQL_cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-12-24</div><div class="title">高级SQL 简读</div></div></a></div><div><a href="/2025/12/22/DB_%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B%E7%AE%80%E8%AF%BB/" title="关系模型 简读"><img class="cover" src="/img/db_cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-12-22</div><div class="title">关系模型 简读</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src="/img/my_avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"><div class="author-intro" style="line-height: 1.7; text-align: center; font-family: inherit; margin-top: -0.5rem; margin-bottom: 0.5rem;">
  <p style="font-size: 1.15rem; margin-bottom: 0.8rem; font-weight: 500; color: var(--anzhiyu-fontcolor);">你好，我是 <span style="color: #00ffcc; font-weight: 600; text-shadow: 0 0 5px #00ffccaa;">Yuejin Wu</span>！👋</p>
  <p style="font-size: 1.05rem; margin-bottom: 0.6rem; opacity: 0.9; color: var(--anzhiyu-fontcolor);">BUPT 本科生 · 人工智能专业</p>
  <p style="font-size: 1.05rem; margin-bottom: 1rem; opacity: 0.9; color: var(--anzhiyu-fontcolor);">记录学习、思考与生活</p>
  <p style="font-size: 1.1rem; margin-top: 1rem; padding-top: 0.8rem; border-top: 1px solid var(--anzhiyu-theme-op); font-weight: 600; color: #FF0066; text-shadow: 0 0 5px #FF0066, 0 0 5px #FF0066aa;">
   保持好奇，持续探索
  </p>
</div>
</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Yuejin Wu</h1><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/YuejinWu/YuejinWu.github.io" target="_blank" title="Github"></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%BC%8F%E5%9B%BE%E7%A4%BA"><span class="toc-number">1.</span> <span class="toc-text">数据库关系模式图示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E8%BF%9E%E6%8E%A5%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">4.1 连接表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">2.1.</span> <span class="toc-text">(1) 自然连接操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.2.</span> <span class="toc-text">(2) 外连接</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.2.1.</span> <span class="toc-text">1. 左外连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.2.2.</span> <span class="toc-text">2. 右外连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%85%A8%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.2.3.</span> <span class="toc-text">3. 全外连接</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%85%B3%E7%B3%BB-%E2%80%93-%E7%A4%BA%E4%BE%8B"><span class="toc-number">2.3.</span> <span class="toc-text">连接关系 – 示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E8%A7%86%E5%9B%BE"><span class="toc-number">3.</span> <span class="toc-text">4.2 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E5%AE%9A%E4%B9%89"><span class="toc-number">3.1.</span> <span class="toc-text">视图定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E5%AE%9A%E4%B9%89%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.2.</span> <span class="toc-text">视图定义语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%A4%BA%E4%BE%8B"><span class="toc-number">3.3.</span> <span class="toc-text">视图示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%85%B6%E4%BB%96%E8%A7%86%E5%9B%BE%E5%AE%9A%E4%B9%89%E7%9A%84%E8%A7%86%E5%9B%BE"><span class="toc-number">3.4.</span> <span class="toc-text">使用其他视图定义的视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E5%B1%95%E5%BC%80"><span class="toc-number">3.5.</span> <span class="toc-text">视图展开</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E6%9B%B4%E6%96%B0"><span class="toc-number">3.6.</span> <span class="toc-text">视图的更新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E4%BA%8B%E5%8A%A1"><span class="toc-number">4.</span> <span class="toc-text">4.3 事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%A4%BA%E4%BE%8B%EF%BC%9A%E9%93%B6%E8%A1%8C%E8%B4%A6%E6%88%B7%E8%BD%AC%E8%B4%A6"><span class="toc-number">4.1.</span> <span class="toc-text">事务示例：银行账户转账</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#T-SQL-%E4%BA%8B%E5%8A%A1%E7%A4%BA%E4%BE%8B"><span class="toc-number">4.2.</span> <span class="toc-text">T-SQL 事务示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-number">5.</span> <span class="toc-text">4.4 完整性约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F%E5%88%86%E7%B1%BB"><span class="toc-number">5.1.</span> <span class="toc-text">完整性约束分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F%E7%A4%BA%E4%BE%8B"><span class="toc-number">5.2.</span> <span class="toc-text">完整性约束示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%B3%E7%B3%BB%E4%B8%8A%E7%9A%84%E7%BA%A6%E6%9D%9F"><span class="toc-number">5.3.</span> <span class="toc-text">单关系上的约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Not-Null-%E7%BA%A6%E6%9D%9F"><span class="toc-number">5.3.1.</span> <span class="toc-text">Not Null 约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unique-%E7%BA%A6%E6%9D%9F"><span class="toc-number">5.3.2.</span> <span class="toc-text">Unique 约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Check-%E5%AD%90%E5%8F%A5"><span class="toc-number">5.3.3.</span> <span class="toc-text">Check 子句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E7%85%A7%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">5.4.</span> <span class="toc-text">参照完整性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E7%85%A7%E5%AE%8C%E6%95%B4%E6%80%A7%E4%BE%9D%E8%B5%96"><span class="toc-number">5.4.1.</span> <span class="toc-text">参照完整性依赖</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E7%85%A7%E5%AE%8C%E6%95%B4%E6%80%A7%E5%A3%B0%E6%98%8E"><span class="toc-number">5.5.</span> <span class="toc-text">参照完整性声明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E7%85%A7%E5%AE%8C%E6%95%B4%E6%80%A7%E4%B8%AD%E7%9A%84%E7%BA%A7%E8%81%94%E6%93%8D%E4%BD%9C"><span class="toc-number">5.6.</span> <span class="toc-text">参照完整性中的级联操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E6%9C%9F%E9%97%B4%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F%E8%BF%9D%E5%8F%8D"><span class="toc-number">5.7.</span> <span class="toc-text">事务期间的完整性约束违反</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.</span> <span class="toc-text">4.5 数据类型和模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.1.</span> <span class="toc-text">内置数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">6.2.</span> <span class="toc-text">类型转换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#B-%E4%BD%BF%E7%94%A8%E5%8C%85%E5%90%AB%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6%E7%9A%84-CAST"><span class="toc-number">6.2.1.</span> <span class="toc-text">B. 使用包含算术运算符的 CAST</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-%E4%BD%BF%E7%94%A8-CAST-%E8%BF%9B%E8%A1%8C%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.2.2.</span> <span class="toc-text">C. 使用 CAST 进行连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#D-%E4%BD%BF%E7%94%A8-CAST-%E7%94%9F%E6%88%90%E5%8F%AF%E8%AF%BB%E6%80%A7%E6%9B%B4%E9%AB%98%E7%9A%84%E6%96%87%E6%9C%AC"><span class="toc-number">6.2.3.</span> <span class="toc-text">D. 使用 CAST 生成可读性更高的文本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">6.3.</span> <span class="toc-text">默认值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B"><span class="toc-number">6.4.</span> <span class="toc-text">用户定义类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E5%9F%9F"><span class="toc-number">6.5.</span> <span class="toc-text">用户定义域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E6%9D%82%E6%A3%80%E6%9F%A5%E6%9D%A1%E4%BB%B6%E5%92%8C%E6%96%AD%E8%A8%80"><span class="toc-number">6.6.</span> <span class="toc-text">复杂检查条件和断言</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-SQL-%E4%B8%AD%E7%9A%84%E7%B4%A2%E5%BC%95%E5%AE%9A%E4%B9%89"><span class="toc-number">7.</span> <span class="toc-text">4.6 SQL 中的索引定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E5%AE%9A%E4%B9%89%E7%A4%BA%E4%BE%8B"><span class="toc-number">7.1.</span> <span class="toc-text">索引定义示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7-%E6%8E%88%E6%9D%83"><span class="toc-number">8.</span> <span class="toc-text">4.7 授权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E9%83%A8%E5%88%86%E7%9A%84%E6%8E%88%E6%9D%83%E5%BD%A2%E5%BC%8F"><span class="toc-number">8.1.</span> <span class="toc-text">对数据库部分的授权形式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%BC%8F%E4%BF%AE%E6%94%B9%E7%9A%84%E6%8E%88%E6%9D%83%E5%BD%A2%E5%BC%8F%EF%BC%88%E7%AC%AC8%E7%AB%A0%EF%BC%89"><span class="toc-number">8.2.</span> <span class="toc-text">对数据库模式修改的授权形式（第8章）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%88%E6%9D%83%E8%A7%84%E8%8C%83"><span class="toc-number">8.3.</span> <span class="toc-text">授权规范</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E7%B1%BB%E5%9E%8B"><span class="toc-number">8.4.</span> <span class="toc-text">权限类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%92%A4%E9%94%80%E6%8E%88%E6%9D%83"><span class="toc-number">8.5.</span> <span class="toc-text">撤销授权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%92%E8%89%B2"><span class="toc-number">8.6.</span> <span class="toc-text">角色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E4%B8%8A%E7%9A%84%E6%8E%88%E6%9D%83"><span class="toc-number">8.7.</span> <span class="toc-text">视图上的授权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%8E%88%E6%9D%83%E7%89%B9%E6%80%A7"><span class="toc-number">8.8.</span> <span class="toc-text">其他授权特性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%E4%B8%8E%E8%AE%A8%E8%AE%BA"><span class="toc-number">9.</span> <span class="toc-text">实验要求与讨论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82%EF%BC%9A%E5%A4%96%E9%94%AE%E5%85%B3%E8%81%94%E4%B8%8E%E7%BA%A7%E8%81%94%E6%93%8D%E4%BD%9C"><span class="toc-number">9.1.</span> <span class="toc-text">实验要求：外键关联与级联操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E6%97%B6%EF%BC%8C%E6%98%AF%E5%90%A6%E4%BD%BF%E7%94%A8%E5%A4%96%E9%94%AE%EF%BC%9F"><span class="toc-number">9.2.</span> <span class="toc-text">数据库系统设计时，是否使用外键？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F1%EF%BC%9A%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%9A%84%E5%A4%96%E9%94%AE"><span class="toc-number">9.2.1.</span> <span class="toc-text">方式1：设置数据库表的外键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F2%EF%BC%9A%E4%B8%8D%E8%AE%BE%E7%BD%AE%E5%A4%96%E9%94%AE%EF%BC%8C%E7%94%B1%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%9C%A8%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91%E5%B1%82%E7%BB%B4%E6%8A%A4%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7%E3%80%81%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">9.2.2.</span> <span class="toc-text">方式2：不设置外键，由应用程序在业务逻辑层维护数据一致性、完整性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%B9%E5%BC%8F3%EF%BC%9A%E4%B8%8D%E8%AE%BE%E7%BD%AE%E5%A4%96%E9%94%AE%EF%BC%8C%E4%B8%9A%E5%8A%A1%E5%B1%82%E5%BA%94%E7%94%A8%E9%80%BB%E8%BE%91%E4%B9%9F%E4%B8%8D%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE%E9%97%B4%E4%B8%80%E8%87%B4%E6%80%A7"><span class="toc-number">9.2.3.</span> <span class="toc-text">方式3：不设置外键，业务层应用逻辑也不处理数据间一致性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LTE-%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BE%E7%A8%8B%E5%AE%9E%E9%AA%8C%E8%AE%A8%E8%AE%BA"><span class="toc-number">9.3.</span> <span class="toc-text">LTE 网络数据库课程实验讨论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LTE-%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E9%AA%8C%E8%A6%81%E6%B1%82"><span class="toc-number">9.4.</span> <span class="toc-text">LTE 网络数据库实验要求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%99%84%E5%BD%95-4-1-T-SQL-%E4%B8%AD%E7%9A%84-CREATE-TABLE"><span class="toc-number">10.</span> <span class="toc-text">附录 4-1: T-SQL 中的 CREATE TABLE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E7%AB%A0%E5%86%85%E5%AE%B9%E6%80%BB%E7%BB%93%EF%BC%88%E5%A4%A7%E7%BA%B2%EF%BC%89"><span class="toc-number">11.</span> <span class="toc-text">本章内容总结（大纲）</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/26/DB_Schema%20Normalization-Relational%20Database%20Design/" title="Schema Normalization-Relational Database Design 解读"><img src="/img/C7_cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Schema Normalization-Relational Database Design 解读"/></a><div class="content"><a class="title" href="/2025/12/26/DB_Schema%20Normalization-Relational%20Database%20Design/" title="Schema Normalization-Relational Database Design 解读">Schema Normalization-Relational Database Design 解读</a><time datetime="2025-12-26T14:25:50.639Z" title="发表于 2025-12-26 22:25:50">2025-12-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/24/DB_Intermediate%20SQL/" title="Intermediate-SQL 解读"><img src="/img/SQL_cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Intermediate-SQL 解读"/></a><div class="content"><a class="title" href="/2025/12/24/DB_Intermediate%20SQL/" title="Intermediate-SQL 解读">Intermediate-SQL 解读</a><time datetime="2025-12-23T17:45:01.113Z" title="发表于 2025-12-24 01:45:01">2025-12-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/24/DB_AdvancedSQL/" title="Advanced-SQL课件详解"><img src="/img/SQL_cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Advanced-SQL课件详解"/></a><div class="content"><a class="title" href="/2025/12/24/DB_AdvancedSQL/" title="Advanced-SQL课件详解">Advanced-SQL课件详解</a><time datetime="2025-12-23T17:31:49.070Z" title="发表于 2025-12-24 01:31:49">2025-12-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/24/DB_%E9%AB%98%E7%BA%A7SQL%E7%AE%80%E8%AF%BB/" title="高级SQL 简读"><img src="/img/SQL_cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="高级SQL 简读"/></a><div class="content"><a class="title" href="/2025/12/24/DB_%E9%AB%98%E7%BA%A7SQL%E7%AE%80%E8%AF%BB/" title="高级SQL 简读">高级SQL 简读</a><time datetime="2025-12-23T17:27:51.680Z" title="发表于 2025-12-24 01:27:51">2025-12-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/22/DB_SQL%20%E8%AF%AD%E8%A8%80%E7%AE%80%E8%AF%BB/" title="Intro-to-SQL 简读"><img src="/img/SQL_cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Intro-to-SQL 简读"/></a><div class="content"><a class="title" href="/2025/12/22/DB_SQL%20%E8%AF%AD%E8%A8%80%E7%AE%80%E8%AF%BB/" title="Intro-to-SQL 简读">Intro-to-SQL 简读</a><time datetime="2025-12-22T06:53:42.900Z" title="发表于 2025-12-22 14:53:42">2025-12-22</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="Yuejin Wu" target="_blank">Yuejin Wu</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" href="/" title="首页">首页</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">8</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://hexo.anheyu.com/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AI-Platform/" style="font-size: 0.88rem;">AI Platform<sup>1</sup></a><a href="/tags/Database/" style="font-size: 0.88rem;">Database<sup>6</sup></a><a href="/tags/English/" style="font-size: 0.88rem;">English<sup>1</sup></a><a href="/tags/RNN/" style="font-size: 0.88rem;">RNN<sup>1</sup></a><a href="/tags/SQL/" style="font-size: 0.88rem;">SQL<sup>5</sup></a><a href="/tags/Self-Attention/" style="font-size: 0.88rem;">Self Attention<sup>1</sup></a><a href="/tags/plan/" style="font-size: 0.88rem;">plan<sup>2</sup></a><a href="/tags/%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B/" style="font-size: 0.88rem;">关系模型<sup>1</sup></a><a href="/tags/%E8%87%AA%E6%B3%A8%E6%84%8F%E5%8A%9B/" style="font-size: 0.88rem;">自注意力<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@6.1.6/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.7.0",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Yuejin Wu 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://cdn.cbd.int/qrcodejs@1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>